<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>My Bookmarks</title>
<style>
    body {
        font-family: Arial, sans-serif;
        margin: 0;
        padding: 0;
        background-color: var(--bg-color);
        color: var(--text-color);
        transition: background-color 0.3s, color 0.3s;
    }
    .light {
        --bg-color: #fff;
        --text-color: #000;
        --section-bg: #f4f4f4;
    }
    .dark {
        --bg-color: #121212;
        --text-color: #e0e0e0;
        --section-bg: #1e1e1e;
    }
    h2 {
        margin: 0;
        padding: 10px;
        background: var(--section-bg);
        cursor: pointer;
    }
    ul {
        list-style: none;
        padding-left: 20px;
        margin: 0;
    }
    li {
        padding: 5px 0;
    }
    a {
        color: var(--text-color);
        text-decoration: none;
    }
    a:hover {
        text-decoration: underline;
    }
    .toggle-btn {
        position: fixed;
        top: 10px;
        right: 10px;
        padding: 5px 10px;
        cursor: pointer;
        background: var(--section-bg);
        border: none;
        border-radius: 15px;
        color: var(--text-color);
        font-size: 14px;
    }
</style>
</head>
<body>
<button class="toggle-btn">Toggle Dark Mode</button>
<div id="bookmarks"></div>

<script>
    // Theme Handling
    const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
    const savedTheme = localStorage.getItem('theme');
    document.body.classList.add(savedTheme || (prefersDark ? 'dark' : 'light'));

    document.querySelector('.toggle-btn').addEventListener('click', () => {
        document.body.classList.toggle('dark');
        document.body.classList.toggle('light');
        localStorage.setItem('theme', document.body.classList.contains('dark') ? 'dark' : 'light');
    });

    // Fetch and display bookmarks
    fetch('bookmarks.json')
        .then(response => response.json())
        .then(data => {
            const container = document.getElementById('bookmarks');
            const savedState = JSON.parse(localStorage.getItem('collapsedSections') || '{}');

            const createSection = (title, children) => {
                const section = document.createElement('div');
                const header = document.createElement('h2');
                header.textContent = title;
                section.appendChild(header);

                const list = document.createElement('ul');
                list.style.display = savedState[title] ? 'none' : 'block';

                children.forEach(child => {
                    if (child.type === 'folder') {
                        list.appendChild(createSection(child.name, child.children));
                    } else if (child.type === 'url') {
                        const li = document.createElement('li');
                        const a = document.createElement('a');
                        a.href = child.url;
                        a.textContent = child.name;
                        li.appendChild(a);
                        list.appendChild(li);
                    }
                });

                header.addEventListener('click', () => {
                    const isCollapsed = list.style.display === 'none';
                    list.style.display = isCollapsed ? 'block' : 'none';
                    savedState[title] = !isCollapsed;
                    localStorage.setItem('collapsedSections', JSON.stringify(savedState));
                });

                section.appendChild(list);
                return section;
            };

            // Move Toolbar and its subfolders to the top
            data.sort((a, b) => {
                if (a.name === 'Toolbar') return -1;
                if (b.name === 'Toolbar') return 1;
                return a.name.localeCompare(b.name);
            });

            data.forEach(folder => {
                if (folder.type === 'folder') {
                    container.appendChild(createSection(folder.name, folder.children));
                }
            });
        });
</script>
</body>
</html>
